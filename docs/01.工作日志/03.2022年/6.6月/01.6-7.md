---
title: 6-7
date: 2022-06-7 09:59:35
permalink: /pages/c3ff57/
categories:
  - 工作日志
  - 2022年
  - 6月
tags:
  - 
---
## 今日工作内容

- 综合处方合并支付部署联调，增加查询商品详情代码
- RWD权限相关代码评审
- 排查log.error无法打全堆栈的问题


### 问题描述，`log.error("xxx",e)` 无法打印出完整日志堆栈

有问题的定投查询参数：
{"businessId":9,"businessLocationId":"13764006","viewer":"333212500003","viewerType":2}

查询已推荐列表参数：
 {
        "accountPin": "jd_hNNerpjBlLuM",
        "accountType": 1,
        "diagId": 218321810907863,
        "doctorId": 272511232712,
        "pageIndex": 1,
        "pageSize": 10,
        "tenantId": "JD8888",
        "businessLine": 1,
        "scene": 3,
        "businessId": "218321810907863"
    }

答：HotSpot JVM 有医生省略堆栈跟踪的功能，添加JVM参数：`-XX:-OmitStackTraceInFastThrow` 关闭此优化即可。
详细见stackoverflow：<https://stackoverflow.com/questions/40502576/java-lang-classcastexception-with-null-message-and-cause>

### 类似的，空指针时没有堆栈，如何处理？
详见：<https://stackoverflow.com/questions/2411487/nullpointerexception-in-java-with-no-stacktrace>


### 破窗理论
一栋大厦上有一扇破损的窗户，那么，慢慢的大厦的外墙就会有人涂鸦，会有越多来越多的人去破坏，最终整个大厦都会荒芜。







